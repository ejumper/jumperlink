<section class="blogpost">
    <h2>Demonstrated Skills</h2> 
    <ul class="skills"> 
        <li>Creating Global Security Groups</li> 
        <li>Assigning FGPP to users and groups </li> 
        <li>Microsoft &amp; NIST password policy recommendations</li> 
        <li>Using PowerShell</li> 
    </ul> 
    <h2>Overview</h2> 
    <p>In Active Directory, the Default Domain Policy enforces a single password policy across all users. This is not suitable for enterprise networks where administrators require strict authentication policies to maintain domain security and standard users need quick simple access to their machines. Fine-Grained Password Policies solve this problem by allowing administrators to create multiple password policies within a single domain. In this post I will go through the process of creating one using both the Administrative Center and PowerShell. I have two OUs in my domain, \_ADMINS and \_USERS I will create a FGPP for each that reflects their security needs</p> 
    <h2>ADAC</h2> 
    <p>I begin in <strong>Server Manager</strong> and go to <strong>Tools &gt; Users and Computers</strong>. FGPPs can not be applied directly to a OU so I will first have to create Global Security Groups for my Standard Users and my Admins.</p> <p>I go to the OU containing my Standard Users <strong>Right click &gt; select New &gt; Select Group</strong> and in the <strong>New Object - Group window</strong> I <strong>give the group a name, set the scope to Global and the group type to Security</strong> as required for FGPPs.</p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604150326.png"></p> <p>I then use <strong>ctrl+a to select all the users and ctrl+left-click to deselect the Group</strong>, then I <strong>right-click, select add to a group and set object type to Groups, and type in Standard Users (the name of the Group I created) then Check names and OK</strong> I get a pop-up confirming that the policy has been set.</p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604151102.png"></p> <p>Now I can go to <strong>Active Director Administrative Center (dsac.exe)</strong> and actually create the FGPP. I go to the left hand "Overview" menu and <strong>expand my domain &gt; expand system &gt; and select Password Settings Container</strong></p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604142525.png"></p> <p>Then in the right hand Tasks Pane I <strong>select New &gt; Password Settings</strong></p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604142724.png"></p> <p>Under <strong>Directly Applies To I select Add</strong> and <strong>select Groups for Object Types, \_USERS for Location &amp; then type in Standard Users &amp; check names</strong></p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604152737.png"></p> <p>Now I will add the Password Settings. I give it a name and then <strong>Set Precedence to 20</strong> this will allow me to set a higher number for \_ADMINS so the admin policy always overrides the standard user's policy. I set <strong>Minimum length to 15</strong>. Microsoft recommends a length of 8, they say this to encourage unique passwords, however in their newest guidelines NIST recommends a minimum of 15 characters this aligns with their movement away from complexity and toward length as the most secure practice. Microsoft recommends the maximum value of <strong>24 for password history</strong> to mitigate password reuse. I set <strong>minimum password age to 1</strong> to protect against password cycling to bypass history settings. For maximum password age Microsoft recommends between 30-90 days so I will set a middle value of <strong>60 day maximum password age</strong> for standard users. Microsoft recommends a baseline of <strong>10 for failed logon attempts</strong> I will use this maximum recommendation for standard users and lower it for admins. I select <strong>20 minutes before logon attempts reset</strong>. I figure that this will allow time for a response if necessary while also being short enough to wait out if it is just a forgetful user.</p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604155753.png"></p> <h2>PowerShell</h2> <p>For the admin password policy, since there is only one admin, rather than creating a new Group I will simply apply it to the user.</p> <p>I right click on PowerShell to run it as an Administrator and enter the following command to create a new FGPP.</p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604160751.png"></p> <p>For Admin I set the precedence to 10 to override the standard user policy, I lowered the lockout threshold, increased the lockout duration and enabled complexity requirements all to reflect the increased security risk of malicious actors gaining access to an admin account.</p> <p>I then use the following 2 commands to apply the FGPP to a user and verify that the policy was correctly applied.</p> <p><img class="blog-img" src="content/labs/images/Pasted image 20250604161626.png"></p>
</section>